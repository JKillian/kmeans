Object subclass: #KMeans	instanceVariableNames: 'iterations clusters'	classVariableNames: ''	poolDictionaries: ''	category: 'KMeans'!!KMeans commentStamp: '<historical>' prior: 0!!!KMeans methodsFor: 'benchmarks' stamp: 'AndreaFerretti 10/8/2014 19:03'!benchmark: points repeating: repetitions	| time |	time := Time millisecondsToRun: [ self run: points times: repetitions ].	^ time / repetitions.! !!KMeans methodsFor: 'initialization' stamp: 'AndreaFerretti 10/8/2014 18:09'!clusters: anInt	clusters := anInt! !!KMeans methodsFor: 'initialization' stamp: 'AndreaFerretti 10/8/2014 18:09'!iterations: anInt	iterations := anInt! !!KMeans methodsFor: 'algorithm' stamp: 'AndreaFerretti 10/8/2014 18:57'!run: points	| centroids |	centroids := points first: clusters.	iterations timesRepeat: [		centroids := (self cluster: points around: centroids) collect: [ :each | each average ]	 ].	^ self cluster: points around: centroids! !!KMeans methodsFor: 'algorithm' stamp: 'AndreaFerretti 10/8/2014 19:01'!run: points times: times	times timesRepeat: [ self run: points ].! !!KMeans methodsFor: 'algorithm' stamp: 'AndreaFerretti 10/8/2014 18:34'!cluster: points around: centroids	^ (points groupedBy: [ :p | p closestFrom: centroids ]) values! !'From Pharo3.0 of 18 March 2013 [Latest update: #30856] on 10 October 2014 at 12:20:12.009374 pm'!!Point methodsFor: '*KMeans' stamp: 'AndreaFerretti 10/8/2014 18:23'!closestFrom: points	^ points minBy: [ :each | self dist: each ]! !'From Pharo3.0 of 18 March 2013 [Latest update: #30856] on 10 October 2014 at 12:20:12.009374 pm'!!Collection methodsFor: '*KMeans' stamp: 'AndreaFerretti 10/8/2014 18:18'!minBy: aBlock	^ self inject: self anyOne into: [:min :each |		(aBlock value: min) < (aBlock value: each)			ifTrue: [ min ]			ifFalse: [ each ] 	]! !